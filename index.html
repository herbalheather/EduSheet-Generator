<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduSheet Generator | Mama Said This - Fun Worksheets That Spark Joy!</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { 
            --primary: #e85d75; 
            --secondary: #6366f1; 
            --accent: #fbbf24; 
            --light: #f8fafc; 
            --dark: #1e293b; 
            --success: #10b981;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Inter', sans-serif; 
            color: var(--dark); 
            background: var(--light); 
            padding: 1rem; 
            max-width: 1200px; 
            margin: 0 auto; 
            line-height: 1.6;
        }
        @media (max-width: 768px) { body { padding: 0.5rem; } }
        .nav { display: flex; gap: 1rem; margin-bottom: 2rem; }
        .back-btn { 
            padding: 0.6rem 1.2rem; 
            background: var(--secondary); 
            color: white; 
            text-decoration: none; 
            border-radius: 25px; 
            font-weight: 600; 
            transition: all 0.3s; 
            display: inline-flex; align-items: center; gap: 0.5rem;
        }
        .back-btn:hover { background: #4f46e5; transform: scale(1.05); }
        h1 { 
            font-family: 'Poppins', sans-serif; 
            font-size: 2.5rem; 
            background: var(--gradient); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            text-align: center; 
            margin-bottom: 1rem; 
            animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow { from { text-shadow: 0 0 5px rgba(102, 126, 234, 0.5); } to { text-shadow: 0 0 20px rgba(102, 126, 234, 0.8); } }
        .subtitle { text-align: center; color: #64748b; font-size: 1.1rem; margin-bottom: 2rem; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem; }
        @media (max-width: 768px) { .form-grid { grid-template-columns: 1fr; } }
        .form-group { background: white; padding: 1.5rem; border-radius: 16px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        label { display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary); }
        select, input { width: 100%; padding: 0.8rem; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem; transition: border-color 0.3s; }
        select:focus, input:focus { border-color: var(--primary); outline: none; }
        .theme-option { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; border-radius: 8px; cursor: pointer; transition: background 0.3s; }
        .theme-option:hover { background: #f0f9ff; }
        .theme-option.selected { background: #dbeafe; border: 2px solid var(--secondary); }
        .theme-emoji { font-size: 1.5rem; }
        .type-desc, .subject-desc { font-size: 0.9rem; color: #94a3b8; margin-top: 0.25rem; }
        #preview { 
            background: white; 
            padding: 2rem; 
            border-radius: 16px; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.1); 
            margin-bottom: 2rem; 
            min-height: 300px; 
            display: flex; align-items: center; justify-content: center; 
            flex-direction: column; 
            text-align: center;
        }
        #preview-content { opacity: 0; transition: opacity 0.5s; }
        #preview-content.show { opacity: 1; }
        .btn { 
            padding: 1rem 2rem; 
            background: var(--primary); 
            color: white; 
            border: none; 
            border-radius: 50px; 
            font-weight: 700; 
            cursor: pointer; 
            transition: all 0.3s; 
            font-size: 1.1rem;
            display: block; margin: 1rem auto;
        }
        .btn:hover { background: #d14361; transform: translateY(-2px); box-shadow: 0 10px 20px rgba(232,93,117,0.3); }
        .btn:disabled { background: #9ca3af; cursor: not-allowed; transform: none; }
        .btn-success { background: var(--success); }
        .btn-success:hover { background: #059669; }
        .tips { background: #fef3c7; padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; }
        .tips h3 { color: #92400e; margin-bottom: 1rem; }
        .tips ul { list-style: none; }
        .tips li { margin-bottom: 0.5rem; padding-left: 1rem; position: relative; }
        .tips li::before { content: '‚ú®'; position: absolute; left: 0; }
        .required { color: #ef4444; font-weight: bold; }
        .nav-tabs { display: flex; justify-content: center; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap; }
        .nav-tab { padding: 0.5rem 1rem; background: #e5e7eb; border-radius: 25px; text-decoration: none; color: var(--dark); font-weight: 600; transition: all 0.3s; }
        .nav-tab:hover, .nav-tab.active { background: var(--secondary); color: white; }
        .hidden { display: none; }
        #assessment, #library { padding: 2rem; background: white; border-radius: 16px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); margin-top: 2rem; }
        .quiz-question { margin-bottom: 1.5rem; }
        .quiz-options { display: flex; flex-direction: column; gap: 0.5rem; }
        .quiz-option { padding: 0.8rem; border: 2px solid #e2e8f0; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .quiz-option:hover { border-color: var(--primary); }
        .quiz-option.selected { background: #dbeafe; border-color: var(--secondary); }
        .resource-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; }
        .resource-card { background: #f8fafc; padding: 1rem; border-radius: 12px; border-left: 4px solid var(--accent); }
        .resource-card h4 { color: var(--primary); margin-bottom: 0.5rem; }
        .download-link { color: var(--success); text-decoration: none; font-weight: 600; }
        .download-link:hover { text-decoration: underline; }
        .confetti { pointer-events: none; }
        .save-template { background: var(--accent); color: var(--dark); margin-left: 1rem; }
        .save-template:hover { background: #f59e0b; }
        .problem { margin-bottom: 1rem; font-size: 1.2rem; text-align: center; }
        .wordsearch-grid { font-family: monospace; background: #f3f4f6; padding: 1rem; border-radius: 8px; margin: 1rem 0; }
        .coloring-placeholder { border: 2px dashed var(--accent); padding: 2rem; margin: 1rem 0; text-align: center; font-size: 1.5rem; }
        .optgroup-desc { font-style: italic; color: #94a3b8; }
    </style>
</head>
<body>
    <div class="nav">
        <a href="https://edusheet-chooser.pages.dev/" class="back-btn">‚Üê Back to Chooser</a>
        <a href="https://mamasaid-this.pages.dev/" class="back-btn">üè† Home</a>
    </div>
    
    <div class="nav-tabs">
        <a href="#" class="nav-tab active" data-section="generator">Worksheet Generator</a>
        <a href="#" class="nav-tab" data-section="assessment">Learning Style Quiz ‚ú®</a>
        <a href="#" class="nav-tab" data-section="library">Resource Library üìö</a>
    </div>
    
    <!-- Main Generator -->
    <section id="generator">
        <h1>Create Epic Educational Worksheets! üöÄ</h1>
        <p class="subtitle">Mix grades, subjects, & themes for worksheets that kids actually *want* to do. No boring busywork‚Äîpure fun learning magic!</p>
        
        <div class="form-grid">
            <div class="form-group">
                <label for="grade">Grade Level <span class="required">*</span></label>
                <select id="grade" onchange="updatePreview()">
                    <option value="">Select Grade</option>
                    <option value="grade1">Grade 1</option>
                    <option value="grade2">Grade 2</option>
                    <option value="grade3">Grade 3</option>
                    <option value="grade4">Grade 4</option>
                    <option value="grade5">Grade 5</option>
                    <option value="grade6">Grade 6</option>
                </select>
                
                <label for="subject">Subject <span class="required">*</span></label>
                <select id="subject" onchange="updatePreview()">
                    <option value="">Choose Subject</option>
                    <optgroup label="Mathematics">
                        <option value="math" data-desc="Numbers, operations, geometry, & problem solving">Mathematics</option>
                    </optgroup>
                    <optgroup label="Science">
                        <option value="science" data-desc="Nature, experiments, animals, & discovery">Science</option>
                    </optgroup>
                    <optgroup label="Reading Comprehension">
                        <option value="reading" data-desc="Stories, vocabulary, & understanding">Reading Comprehension</option>
                    </optgroup>
                </select>
                <small id="subject-desc" class="subject-desc"></small>
                
                <label for="type">Worksheet Type <span class="required">*</span></label>
                <select id="type" onchange="updatePreview()">
                    <option value="">Pick Type</option>
                    <optgroup label="Creative Fun">
                        <option value="coloring" data-desc="Black & white images to color | K-3 | 15-30 min">Coloring Sheet</option>
                    </optgroup>
                    <optgroup label="Puzzle Power">
                        <option value="wordsearch" data-desc="Find hidden words | 2-6 | 10-25 min">Word Search</option>
                    </optgroup>
                    <optgroup label="Brain Teasers">
                        <option value="quiz" data-desc="Multiple choice & short answers | 1-6 | 20-40 min">Question Quiz</option>
                        <option value="math" data-desc="Grade-appropriate problems | K-6 | 20-40 min">Math Practice</option>
                    </optgroup>
                </select>
                <small id="type-desc" class="type-desc"></small>
            </div>
            
            <div class="form-group">
                <label>Theme <span class="required">*</span></label>
                <div id="themes" style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <div class="theme-option" onclick="selectTheme('space', this)"><span class="theme-emoji">üöÄ</span> Space Adventure<br><small>Rockets, planets, astronauts, cosmic fun!</small></div>
                    <div class="theme-option" onclick="selectTheme('animals', this)"><span class="theme-emoji">ü¶Å</span> Animal Kingdom<br><small>Wildlife, pets, jungle vibes & nature</small></div>
                    <div class="theme-option" onclick="selectTheme('sea', this)"><span class="theme-emoji">üêü</span> Under the Sea<br><small>Sea creatures, underwater world</small></div>
                    <div class="theme-option" onclick="selectTheme('dinos', this)"><span class="theme-emoji">ü¶ï</span> Dinosaur World<br><small>Prehistoric beasts, fossils, ancient times</small></div>
                    <div class="theme-option" onclick="selectTheme('nature', this)"><span class="theme-emoji">üå≥</span> Nature Explorer<br><small>Plants, trees, seasons, outdoor adventures</small></div>
                    <div class="theme-option" onclick="selectTheme('transport', this)"><span class="theme-emoji">üöó</span> Transportation<br><small>Cars, trains, planes, speedy vehicles</small></div>
                </div>
                
                <label for="difficulty">Difficulty Level <span class="required">*</span></label>
                <select id="difficulty" onchange="updatePreview()">
                    <option value="">Choose Level</option>
                    <option value="easy">Easy ü•≥<br><small>Grade-level basics‚Äîsuper approachable!</small></option>
                    <option value="medium">Medium ‚ö°<br><small>Slightly advanced‚Äîmoderate challenges</small></option>
                    <option value="pro">Pro üî•<br><small>Above grade‚Äîcomplex & exciting!</small></option>
                </select>
            </div>
        </div>
        
        <div id="preview">
            <h2>Live Preview ‚ú®</h2>
            <p>Fill in the fields above to see your custom worksheet magic unfold!</p>
            <div id="preview-content"></div>
        </div>
        
        <button class="btn" onclick="generateWorksheet()" id="genBtn" disabled>üöÄ Smart Generate Worksheet!</button>
        <div id="actionBtns" class="hidden" style="text-align: center;">
            <button class="btn btn-success" onclick="downloadPDF()">üíæ Download PDF</button>
            <button class="btn save-template" onclick="saveTemplate()">üìÅ Save Template</button>
        </div>
        
        <div class="tips">
            <h3>Smart Tips for Epic Sheets ‚ú®</h3>
            <ul>
                <li>Coloring sheets shine with simple themes like Nature or Animals!</li>
                <li>Word searches auto-tune to your grade's reading level‚Äîzero frustration.</li>
                <li>Math problems level up with difficulty‚ÄîPro mode for those "aha!" moments.</li>
                <li>Quizzes blend subjects & themes for stories kids can't put down.</li>
            </ul>
        </div>
        
        <div style="text-align: center; color: #ef4444; font-weight: bold;">
            <p id="requiredMsg">Complete the required fields to unlock the fun! üéâ</p>
        </div>
    </section>
    
    <!-- Learning Style Assessment -->
    <section id="assessment" class="hidden">
        <h1>Discover Your Kid's Learning Superpowers! ü¶∏‚Äç‚ôÄÔ∏è</h1>
        <p class="subtitle">Quick 5-question quiz to match styles‚ÄîVisual, Auditory, Kinesthetic? Tailor worksheets to *their* vibe!</p>
        
        <form id="quizForm">
            <div class="quiz-question">
                <p>1. When learning new info, does your kid...</p>
                <div class="quiz-options">
                    <div class="quiz-option" data-answer="0" onclick="selectOption(this)">Draw pictures or watch videos? (Visual)</div>
                    <div class="quiz-option" data-answer="1" onclick="selectOption(this)">Talk it out or listen to stories? (Auditory)</div>
                    <div class="quiz-option" data-answer="2" onclick="selectOption(this)">Build stuff or move around? (Kinesthetic)</div>
                </div>
            </div>
            <div class="quiz-question">
                <p>2. For remembering facts...</p>
                <div class="quiz-options">
                    <div class="quiz-option" data-answer="0" onclick="selectOption(this)">Make mind maps or diagrams? (Visual)</div>
                    <div class="quiz-option" data-answer="1" onclick="selectOption(this)">Repeat aloud or use rhymes? (Auditory)</div>
                    <div class="quiz-option" data-answer="2" onclick="selectOption(this)">Walk while reciting or use gestures? (Kinesthetic)</div>
                </div>
            </div>
            <div class="quiz-question">
                <p>3. In class/group work...</p>
                <div class="quiz-options">
                    <div class="quiz-option" data-answer="0" onclick="selectOption(this)">Watch demos or read instructions? (Visual)</div>
                    <div class="quiz-option" data-answer="1" onclick="selectOption(this)">Discuss ideas out loud? (Auditory)</div>
                    <div class="quiz-option" data-answer="2" onclick="selectOption(this)">Hands-on experiments or role-play? (Kinesthetic)</div>
                </div>
            </div>
            <div class="quiz-question">
                <p>4. Best way to explain something...</p>
                <div class="quiz-options">
                    <div class="quiz-option" data-answer="0" onclick="selectOption(this)">Sketch it or show a video? (Visual)</div>
                    <div class="quiz-option" data-answer="1" onclick="selectOption(this)">Tell a story or describe verbally? (Auditory)</div>
                    <div class="quiz-option" data-answer="2" onclick="selectOption(this)">Demonstrate physically? (Kinesthetic)</div>
                </div>
            </div>
            <div class="quiz-question">
                <p>5. For fun learning...</p>
                <div class="quiz-options">
                    <div class="quiz-option" data-answer="0" onclick="selectOption(this)">Watch educational shows? (Visual)</div>
                    <div class="quiz-option" data-answer="1" onclick="selectOption(this)">Listen to podcasts or audiobooks? (Auditory)</div>
                    <div class="quiz-option" data-answer="2" onclick="selectOption(this)">Play active games or build models? (Kinesthetic)</div>
                </div>
            </div>
            <button type="submit" class="btn">Get Results! üåü</button>
        </form>
        <div id="quizResults" class="hidden" style="margin-top: 2rem; padding: 1.5rem; background: #f0fdf4; border-radius: 12px; border-left: 4px solid var(--success);">
            <h2>Your Learning Style: <span id="style"></span> üéØ</h2>
            <p id="recs"></p>
            <p>Pro Tip: Use this in the generator for personalized tweaks! E.g., Visual kids love Space themes with diagrams.</p>
        </div>
    </section>
    
    <!-- Resource Library -->
    <section id="library" class="hidden">
        <h1>Resource Library: Free Goodies Await! üìö</h1>
        <p class="subtitle">Curated downloads, guides, & extras to supercharge your teaching. Search, grab, & go!</p>
        
        <input type="text" id="searchRes" placeholder="Search resources (e.g., math guides)..." onkeyup="filterResources()" style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 2px solid #e2e8f0; border-radius: 10px;">
        
        <div class="resource-grid" id="resGrid">
            <div class="resource-card" data-tags="math">
                <h4>Math Starter Pack</h4>
                <p>Basic ops cheat sheet & games for K-3.</p>
                <a href="#" class="download-link" onclick="downloadRes('math-starter.pdf')">Download PDF üì•</a>
            </div>
            <div class="resource-card" data-tags="science">
                <h4>Science Experiments Kit</h4>
                <p>10 easy home labs with themes like Under the Sea.</p>
                <a href="#" class="download-link" onclick="downloadRes('science-kit.pdf')">Download PDF üì•</a>
            </div>
            <div class="resource-card" data-tags="reading">
                <h4>Reading Adventure Guide</h4>
                <p>Story prompts & vocab builders for any theme.</p>
                <a href="#" class="download-link" onclick="downloadRes('reading-guide.pdf')">Download PDF üì•</a>
            </div>
            <div class="resource-card" data-tags="quiz">
                <h4>Quiz Master Templates</h4>
                <p>Ready-to-edit question banks for all grades.</p>
                <a href="#" class="download-link" onclick="downloadRes('quiz-templates.pdf')">Download PDF üì•</a>
            </div>
            <div class="resource-card" data-tags="wordsearch">
                <h4>Word Search Extras</h4>
                <p>Bonus grids & answer keys for themes.</p>
                <a href="#" class="download-link" onclick="downloadRes('wordsearch-extras.pdf')">Download PDF üì•</a>
            </div>
            <div class="resource-card" data-tags="coloring">
                <h4>Coloring Pages Pack</h4>
                <p>Printable line art for 6 themes.</p>
                <a href="#" class="download-link" onclick="downloadRes('coloring-pack.pdf')">Download PDF üì•</a>
            </div>
        </div>
    </section>

    <script>
        let selectedTheme = '';
        let quizAnswers = new Array(5).fill(-1); // One per question
        
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                const section = e.target.dataset.section;
                showSection(section);
            });
        });
        
        function showSection(section) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById(section).classList.remove('hidden');
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-section="${section}"]`).classList.add('active');
            if (section === 'assessment') resetQuiz();
        }
        
        function selectTheme(theme, el) {
            selectedTheme = theme;
            document.querySelectorAll('#themes .theme-option').forEach(t => t.classList.remove('selected'));
            el.classList.add('selected');
            updatePreview();
        }
        
        function updatePreview() {
            const grade = document.getElementById('grade').value;
            const subject = document.getElementById('subject');
            const type = document.getElementById('type');
            const difficulty = document.getElementById('difficulty').value;
            const preview = document.getElementById('preview-content');
            const genBtn = document.getElementById('genBtn');
            const requiredMsg = document.getElementById('requiredMsg');
            const actionBtns = document.getElementById('actionBtns');
            
            // Update descs
            document.getElementById('subject-desc').textContent = subject.options[subject.selectedIndex]?.dataset.desc || '';
            document.getElementById('type-desc').textContent = type.options[type.selectedIndex]?.dataset.desc || '';
            
            if (grade && subject.value && type.value && selectedTheme && difficulty) {
                genBtn.disabled = false;
                requiredMsg.style.display = 'none';
                actionBtns.classList.add('hidden');
                preview.innerHTML = `
                    <h3>Preview: ${type.options[type.selectedIndex].text} on ${selectedTheme.charAt(0).toUpperCase() + selectedTheme.slice(1)} (${difficulty})</h3>
                    <p>Grade ${grade.replace('grade', '')} ${subject.options[subject.selectedIndex].text} vibes incoming! E.g., for Math Pro Space: "Calculate rocket fuel: 5 + 7 = ? üöÄ"</p>
                    <div style="font-size: 2rem; margin-top: 1rem;">‚ú® Coming to life...</div>
                `;
                preview.classList.add('show');
            } else {
                genBtn.disabled = true;
                requiredMsg.style.display = 'block';
                actionBtns.classList.add('hidden');
                preview.innerHTML = '<p>Fill the stars to unlock preview magic! üåü</p>';
                preview.classList.remove('show');
            }
        }
        
        function generateWorksheet() {
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            
            const grade = document.getElementById('grade').value;
            const subject = document.getElementById('subject').value;
            const type = document.getElementById('type').value;
            const theme = selectedTheme;
            const difficulty = document.getElementById('difficulty').value;
            const themeEmojis = { space: 'üöÄ', animals: 'ü¶Å', sea: 'üêü', dinos: 'ü¶ï', nature: 'üå≥', transport: 'üöó' };
            const emoji = themeEmojis[theme] || 'üìù';
            
            let content = `<h1>${theme.toUpperCase()} ${type.toUpperCase()} Worksheet ${emoji}</h1><p>Grade: ${grade} | Subject: ${subject} | Level: ${difficulty}</p>`;
            
            if (type === 'math' || subject === 'math') {
                const maxNum = difficulty === 'easy' ? 10 : difficulty === 'medium' ? 20 : 50;
                const ops = difficulty === 'easy' ? ['+'] : difficulty === 'medium' ? ['+', '-'] : ['+', '-', '*', '/'];
                const problems = [];
                for (let i = 0; i < (difficulty === 'pro' ? 8 : 5); i++) {
                    const a = Math.floor(Math.random() * maxNum) + 1;
                    const b = Math.floor(Math.random() * maxNum) + 1;
                    const op = ops[Math.floor(Math.random() * ops.length)];
                    let expr = `${a} ${op} ${b} = _____`;
                    if (theme === 'space') expr = `Rocket ${expr} üöÄ`;
                    else if (theme === 'animals') expr = `Animal count: ${expr} ü¶Å`;
                    // Add more theme ties...
                    problems.push(`<div class="problem">${i+1}. ${expr}</div>`);
                }
                content += `<ol>${problems.join('')}</ol><div class="answers" style="margin-top: 2rem; background: #f0f8ff; padding: 1rem; border-radius: 8px;"><h4>Answer Key (Parents Only) üîë</h4><ol>${problems.map((p, i) => `<li>${eval(p.match(/\d+ \+ \d+| \d+ - \d+| \d+ \* \d+| \d+ \/ \d+/)[0].replace(/ /g, ''))}</li>`).join('')}</ol></div>`; // Simple eval for answers (secure since controlled)
            } else if (type === 'wordsearch') {
                // Generate simple 5x5 grid with words
                const words = ['ROCKET', 'PLANET', 'STAR']; // Theme-based
                const grid = Array(5).fill().map(() => Array(5).fill(' '));
                // Place words horizontally (simple)
                words.forEach((word, idx) => {
                    const row = idx;
                    for (let j = 0; j < word.length && j < 5; j++) {
                        grid[row][j] = word[j];
                    }
                });
                // Fill rest randomly
                for (let i = 0; i < 5; i++) for (let j = 0; j < 5; j++) if (grid[i][j] === ' ') grid[i][j] = String.fromCharCode(65 + Math.random() * 26);
                content += `<p>Find: ${words.join(', ')} ${emoji}</p><div class="wordsearch-grid">${grid.map(row => row.join(' ')).join('\n')}</div>`;
            } else if (type === 'quiz') {
                const questions = [
                    `1. What's the capital of ${theme}? (Hint: Fun fact!)`,
                    `2. Name 3 things in a ${theme}.`,
                    `3. True/False: ${theme} is awesome!`
                ];
                content += `<ol>${questions.map(q => `<li>${q}</li>`).join('')}</ol><p>Answers: (Parent guide‚Äî1. Imagination City, 2. Varies, 3. True! üòÑ)</p>`;
            } else if (type === 'coloring') {
                content += `<p>Color the ${theme} scene! üé®</p><div class="coloring-placeholder">üöÄ [Space Rocket Line Art - Draw & Color Here!] ü™ê</div><p>Tip: Use crayons for galaxy vibes!</p>`;
            }
            
            document.getElementById('preview-content').innerHTML = content;
            document.getElementById('actionBtns').classList.remove('hidden');
        }
        
        function downloadPDF() {
            const element = document.getElementById('preview');
            html2pdf().set({ margin: 1, filename: 'epic-worksheet.pdf', image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2 }, jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' } }).from(element).save();
            confetti({ particleCount: 50, spread: 60 });
        }
        
        function saveTemplate() {
            const formData = {
                grade: document.getElementById('grade').value,
                subject: document.getElementById('subject').value,
                type: document.getElementById('type').value,
                theme: selectedTheme,
                difficulty: document.getElementById('difficulty').value
            };
            localStorage.setItem('worksheetTemplate', JSON.stringify(formData));
            alert('Template saved! Reload to auto-fill next time. üìÅ');
        }
        
        // Load saved template on init
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('worksheetTemplate');
            if (saved) {
                const data = JSON.parse(saved);
                document.getElementById('grade').value = data.grade;
                document.getElementById('subject').value = data.subject;
                document.getElementById('type').value = data.type;
                document.getElementById('difficulty').value = data.difficulty;
                selectedTheme = data.theme;
                if (selectedTheme) document.querySelector(`[onclick="selectTheme('${selectedTheme}', this)"]`).click();
                updatePreview();
            }
        });
        
        // Quiz Functions
        function selectOption(el) {
            const qIndex = Array.from(el.parentNode.parentNode.parentNode.children).indexOf(el.parentNode.parentNode);
            const answer = parseInt(el.dataset.answer);
            quizAnswers[qIndex] = answer;
            el.parentNode.querySelectorAll('.quiz-option').forEach(o => o.classList.remove('selected'));
            el.classList.add('selected');
        }
        
        function resetQuiz() {
            quizAnswers = new Array(5).fill(-1);
            document.querySelectorAll('.quiz-option').forEach(o => {
                o.classList.remove('selected');
            });
            document.getElementById('quizResults').classList.add('hidden');
        }
        
        document.getElementById('quizForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const visual = quizAnswers.filter(a => a === 0).length;
            const auditory = quizAnswers.filter(a => a === 1).length;
            const kinesthetic = quizAnswers.filter(a => a === 2).length;
            let style = 'Visual';
            let recs = 'Loves images & colors!';
            if (auditory > visual && auditory > kinesthetic) { style = 'Auditory'; recs = 'Thrives on stories & discussions!'; }
            else if (kinesthetic > visual && kinesthetic > auditory) { style = 'Kinesthetic'; recs = 'Energized by hands-on action!'; }
            document.getElementById('style').textContent = style;
            document.getElementById('recs').textContent = recs;
            document.getElementById('quizResults').classList.remove('hidden');
        });
        
        // Resource Functions
        function filterResources() {
            const query = document.getElementById('searchRes').value.toLowerCase();
            document.querySelectorAll('#resGrid .resource-card').forEach(card => {
                const tags = card.dataset.tags.toLowerCase();
                card.style.display = tags.includes(query) || card.textContent.toLowerCase().includes(query) ? 'block' : 'none';
            });
        }
        
        function downloadRes(file) {
            // In real: Create blob or link to PDF; for now, mock
            const link = document.createElement('a');
            link.href = `data:text/plain;charset=utf-8,Downloaded: ${file}`;
            link.download = file;
            link.click();
            alert(`Grabbed ${file}! (Full PDFs coming soon‚Äîstay tuned!)`);
        }
        
        // Init
        updatePreview();
    </script>
</body>
</html>
